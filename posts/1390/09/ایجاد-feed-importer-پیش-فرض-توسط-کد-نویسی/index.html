<!doctype html><html lang="fa" dir="rtl"><head><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="keywords" content="feeds,Drupal,ماژول feeds,ماژول خبرخوان,خبرخوان,دروپال,api,Feed importer,کدنویسی,Programatically,ماژول نویسی دروپال,هوک,ctools,Feed importer,hook_feeds_importer_default,hook_ctools_plugin_api"><meta name="description" content="ایجاد Feed importer یا خبرخوان پیش فرض در دروپال، توسط کدنویسی (ماژول نویسی)"><meta name="geo.region" content="IRAN"><link rel="canonical" href="https://hejazee.github.io/posts/1390/09/%D8%A7%DB%8C%D8%AC%D8%A7%D8%AF-feed-importer-%D9%BE%DB%8C%D8%B4-%D9%81%D8%B1%D8%B6-%D8%AA%D9%88%D8%B3%D8%B7-%DA%A9%D8%AF-%D9%86%D9%88%DB%8C%D8%B3%DB%8C/"><link rel="shortcut icon" href="/favicon.ico" type="image/png"><title>ایجاد Feed importer پیش فرض توسط کد نویسی | وبلاگ رسمی احمد حجازی</title><link rel="stylesheet" href="/lib/bootstrap-5.1.3-dist/css/bootstrap.rtl.min.css"><link rel="stylesheet" href="/lib/fontawesome-free-5.15.2-web/css/all.min.css"><link rel="stylesheet" href="/fonts/fonts.css"><link rel="stylesheet" href="/scss/index.172bdd1266bb92eb39450b3215cc97ecd4d7ec43ae649679fe3140f189d01c32.css" integrity="sha256-FyvdEma7kus5RQsyFcyX7NTX7EOuZJZ5/jFA8YnQHDI=" crossorigin="anonymous"></head><body><nav class="navbar navbar-expand-lg navbar-dark bg-dark" id="farsaran-header-nav"><div class="container"><a class="navbar-brand order-0 flex-grow-1 flex-lg-grow-0" href="/"><img src="/logo.svg" alt="وبلاگ رسمی احمد حجازی" height="34"></a>
<button class="navbar-toggler order-2 order-lg-1" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="نمایش منو">
<span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse mb-3 mb-lg-0" id="navbarSupportedContent"><ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item"><a class="nav-link" href="/contact/">تماس</a></li><li class="nav-item"><a class="nav-link" href="/about/">درباره</a></li></ul></div></div></nav><div class="container mt-4"><div class="row"><div class="col-md-9"><header><h1 class="post-title fw-bold fs-2"><a class="text-dark" href="/posts/1390/09/%D8%A7%DB%8C%D8%AC%D8%A7%D8%AF-feed-importer-%D9%BE%DB%8C%D8%B4-%D9%81%D8%B1%D8%B6-%D8%AA%D9%88%D8%B3%D8%B7-%DA%A9%D8%AF-%D9%86%D9%88%DB%8C%D8%B3%DB%8C/">ایجاد Feed importer پیش فرض توسط کد نویسی</a></h1></header><small class="d-block text-secondary post-date">ارسال شده در
<time datetime="2011-11-27">Nov 27, 2011</time></small><article class="blog-post" role="article" typeof="schema:Article"><p><a href="http://drupal.org/project/feeds">ماژول feeds</a> دروپال یک ماژول فوق العاده است که من بارها از آن در کارهایم استفاده کرده ام و می کنم.<br>در خصوص این ماژول می توانید <a href="http://drupal.org/documentation/modules/feeds">تحقیق کنید و یاد بگیرید</a>.<br>در این مقاله قصد دارم فقط چگونگی ایجاد Feed importer های پیش فرض را توضیح دهم. و هدف هم از این کار، ایجاد یک منبع فارسی برای برنامه نویسان حرفه ای دروپال است.<br>کسانی که آشنایی ندارند، به لینک قبلی مراجعه کنند.</p><hr width="500"><p>Feed importer پیش فرض، به Feed importer هایی می گویند که توسط کد نویسی در داخل ماژول ها به وجود آمده. در مقابل Feed importer هایی که کاربر در محیط گرافیکی درست می کند و در دیتابیس ذخیره می شوند، ولی Feed importer های پیش فرض در دیتابیس ذخیره نمی شوند بلکه در کد ذخیره می شوند.</p><p>برای ایجاد یک Feed importer پیش فرض باید به طریق زیر عمل کنیم:</p><p>1 - ابتدا یک Feed importer را در <a href="http://localhost/admin/build/feeds/create">محیط گرافیکی</a> ایجاد می کنیم. سپس آن پیکربندی کرده و ذخیره می کنیم.</p><p>2 - پس از این که Feed importer به خوبی آماده شد، به صفحه ی admin/build/feeds می رویم و روی لینک Export در جلوی نام Feed importer کلیک می کنیم تا ساختار Feed importer به صورت کد های php به ما تحویل داده شود. مثل زیر:</p><pre class="brush: php;fontsize: 100; first-line: 1;">&lt;?php
$feeds_importer = new stdClass;
$feeds_importer-&gt;disabled = FALSE; /* Edit this to true to make a default feeds_importer disabled initially */
$feeds_importer-&gt;api_version = 1;
$feeds_importer-&gt;id = 'node';
$feeds_importer-&gt;config = array(
  'name' =&gt; 'Node import',
  'description' =&gt; 'Import nodes from CSV file.',
  'fetcher' =&gt; array(
    'plugin_key' =&gt; 'FeedsFileFetcher',
    'config' =&gt; array(
      'direct' =&gt; FALSE,
    ),
  ),
  'parser' =&gt; array(
    'plugin_key' =&gt; 'FeedsCSVParser',
    'config' =&gt; array(
      'delimiter' =&gt; ',',
    ),
  ),
  'processor' =&gt; array(
    'plugin_key' =&gt; 'FeedsNodeProcessor',
    'config' =&gt; array(
      'content_type' =&gt; 'story',
      'update_existing' =&gt; 1,
      'expire' =&gt; '-1',
      'mappings' =&gt; array(
        0 =&gt; array(
          'source' =&gt; 'title',
          'target' =&gt; 'title',
          'unique' =&gt; FALSE,
        ),
        1 =&gt; array(
          'source' =&gt; 'body',
          'target' =&gt; 'body',
          'unique' =&gt; FALSE,
        ),
        2 =&gt; array(
          'source' =&gt; 'published',
          'target' =&gt; 'created',
          'unique' =&gt; FALSE,
        ),
        3 =&gt; array(
          'source' =&gt; 'guid',
          'target' =&gt; 'guid',
          'unique' =&gt; 1,
        ),
      ),
      'input_format' =&gt; 0,
      'author' =&gt; 0,
    ),
  ),
  'content_type' =&gt; '',
  'update' =&gt; 0,
  'import_period' =&gt; '-1',
  'expire_period' =&gt; 3600,
  'import_on_create' =&gt; 1,
);
?&gt;</pre><p>کد فوق را باید در داخل ماژول خود کپی کنیم.</p><p>3 - برای این منظور، باید هوک hook_feeds_importer_default() را تعریف کنیم.<br>کد فوق، همان طور که می بینید، یک متغیر $feed_importer ایجاد می کند. کافی است که هوک را تعریف کنیم و در انتها همین متغیر را return کنیم:</p><pre class="brush: php;fontsize: 100; first-line: 1;">&lt;?php
/**
* Default definition of 'myimporter'
*/
function mymodule_feeds_importer_default() {
  $export = array();
  $feeds_importer = new stdClass;
  $feeds_importer-&gt;disabled = TRUE;
  $feeds_importer-&gt;api_version = 1;
  $feeds_importer-&gt;id = 'myimporter';
  $feeds_importer-&gt;config = array(
  // ...
  );
  $export['myimporter'] = $feeds_importer;
  return $export;
}
?&gt;</pre><p>4 - سپس، برای این که هوک فوق که تعریف کردیم، وارد عمل شود و کار کند، باید هوک ctools_plugin_api نیز تعریف شود. به صورت زیر:</p><pre class="brush: php;fontsize: 100; first-line: 1;">&lt;?php
function mymodule_ctools_plugin_api($module = '', $api = '') {
  if ($module == "feeds" &amp;amp;&amp;amp; $api == "feeds_importer_default") {
    // The current API version is 1.
    return array("version" =&gt; 1);
  }
}
?&gt;</pre><p>به غیر از روش فوق، می توان از ماژول features نیز استفاده کرد...</p><p>&nbsp;</p><p>مقاله در همین موضوع به انگلیسی: <a href="http://drupal.org/node/622698" target="_blank" rel="nofollow">http://drupal.org/node/622698</a><br>مقالات مرتبط:<br><a href="http://ring.ciard.net/consuming-agrifeeds-drupal-feeds" target="_blank" rel="nofollow">http://ring.ciard.net/consuming-agrifeeds-drupal-feeds</a></p><h5>مطالب مرتبط:</h5><ul><li><a href="/posts/1390/11/%D9%85%D8%B4%D8%AE%D8%B5-%DA%A9%D8%B1%D8%AF%D9%86-%D8%B1%D9%86%DA%AF-%D9%88-%D9%81%D9%88%D9%86%D8%AA-%D9%88-...-%D8%AE%D8%A7%D8%B5-%D8%A8%D8%B1%D8%A7%DB%8C-%D9%BE%D8%B3%D8%AA-%D9%87%D8%A7-%D8%AF%D8%B1-%D8%AF%D8%B1%D9%88%D9%BE%D8%A7%D9%84-%D8%A8%D8%B1-%D8%A7%D8%B3%D8%A7%D8%B3-%D8%AF%D8%B3%D8%AA%D9%87-%D8%A8%D9%86%D8%AF%DB%8C%D9%87%D8%A7%DB%8C-taxonomy/">مشخص کردن رنگ و فونت (و ...) خاص برای پست ها در دروپال بر اساس دسته بندی‌های Taxonomy</a></li><li></li></ul></article></div><aside class="col-md-3 mt-4"><h3>Monthly Archive</h3><ul><li><a href="/month/1395-06/" title="All posts from 1395-06">1395-06</a> (1)</li><li><a href="/month/1395-01/" title="All posts from 1395-01">1395-01</a> (1)</li><li><a href="/month/1394-12/" title="All posts from 1394-12">1394-12</a> (3)</li><li><a href="/month/1394-08/" title="All posts from 1394-08">1394-08</a> (1)</li><li><a href="/month/1394-07/" title="All posts from 1394-07">1394-07</a> (1)</li><li><a href="/month/1394-03/" title="All posts from 1394-03">1394-03</a> (1)</li><li><a href="/month/1394-02/" title="All posts from 1394-02">1394-02</a> (1)</li><li><a href="/month/1393-12/" title="All posts from 1393-12">1393-12</a> (1)</li><li><a href="/month/1393-07/" title="All posts from 1393-07">1393-07</a> (1)</li><li><a href="/month/1393-06/" title="All posts from 1393-06">1393-06</a> (2)</li><li><a href="/month/1393-05/" title="All posts from 1393-05">1393-05</a> (2)</li><li><a href="/month/1393-04/" title="All posts from 1393-04">1393-04</a> (4)</li><li><a href="/month/1393-03/" title="All posts from 1393-03">1393-03</a> (5)</li><li><a href="/month/1393-02/" title="All posts from 1393-02">1393-02</a> (1)</li><li><a href="/month/1393-01/" title="All posts from 1393-01">1393-01</a> (4)</li><li><a href="/month/1392-12/" title="All posts from 1392-12">1392-12</a> (5)</li><li><a href="/month/1392-10/" title="All posts from 1392-10">1392-10</a> (5)</li><li><a href="/month/1392-06/" title="All posts from 1392-06">1392-06</a> (1)</li><li><a href="/month/1392-04/" title="All posts from 1392-04">1392-04</a> (1)</li><li><a href="/month/1392-02/" title="All posts from 1392-02">1392-02</a> (1)</li><li><a href="/month/1392-01/" title="All posts from 1392-01">1392-01</a> (5)</li><li><a href="/month/1391-11/" title="All posts from 1391-11">1391-11</a> (5)</li><li><a href="/month/1391-10/" title="All posts from 1391-10">1391-10</a> (4)</li><li><a href="/month/1391-09/" title="All posts from 1391-09">1391-09</a> (2)</li><li><a href="/month/1391-08/" title="All posts from 1391-08">1391-08</a> (3)</li><li><a href="/month/1391-07/" title="All posts from 1391-07">1391-07</a> (6)</li><li><a href="/month/1391-05/" title="All posts from 1391-05">1391-05</a> (1)</li><li><a href="/month/1391-04/" title="All posts from 1391-04">1391-04</a> (1)</li><li><a href="/month/1391-03/" title="All posts from 1391-03">1391-03</a> (2)</li><li><a href="/month/1391-02/" title="All posts from 1391-02">1391-02</a> (4)</li><li><a href="/month/1391-01/" title="All posts from 1391-01">1391-01</a> (6)</li><li><a href="/month/1390-12/" title="All posts from 1390-12">1390-12</a> (9)</li><li><a href="/month/1390-11/" title="All posts from 1390-11">1390-11</a> (8)</li><li><a href="/month/1390-10/" title="All posts from 1390-10">1390-10</a> (7)</li><li><a href="/month/1390-09/" title="All posts from 1390-09">1390-09</a> (4)</li><li><a href="/month/1390-08/" title="All posts from 1390-08">1390-08</a> (7)</li><li><a href="/month/1390-07/" title="All posts from 1390-07">1390-07</a> (14)</li><li><a href="/month/1390-06/" title="All posts from 1390-06">1390-06</a> (18)</li></ul></aside></div></div><footer id="footer-wrapper"><div id="footer-bottom-wrapper"><div class="container"><div class="row"><div class="col-12"><p dir="ltr">&copy; Copyright 2011-2022 * Ahmad Hejazee * All rights reserved.</p><small dir="ltr">Proudly Powered by Drupal 10 ;)</small></div></div></div></div></footer><script src="/lib/jQuery/jquery-3.6.0.min.js"></script>
<script src="/lib/bootstrap-5.1.3-dist/js/bootstrap.bundle.min.js"></script></body></html>