<!doctype html><html lang="fa" dir="rtl"><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-HTH8HV1F9Z"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-HTH8HV1F9Z', { 'anonymize_ip': false });
}
</script><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="geo.region" content="IRAN"><link rel="canonical" href="https://hejazee.ir/posts/1390/06/%D8%A8%D8%A7%D8%B2-%DA%A9%D8%B1%D8%AF%D9%86-%D9%81%D8%A7%DB%8C%D9%84-%D9%87%D8%A7-%D8%AF%D8%B1-vbscript/"><link rel="shortcut icon" href="/favicon.ico" type="image/png"><title>باز کردن فایل ها در VBScript | وبلاگ رسمی احمد حجازی</title><link rel="stylesheet" href="/lib/bootstrap-5.1.3-dist/css/bootstrap.rtl.min.css"><link rel="stylesheet" href="/lib/fontawesome-free-5.15.2-web/css/all.min.css"><link rel="stylesheet" href="/fonts/fonts.css"><link rel="stylesheet" href="/scss/index.eae19926520d6f18098f9660e787191b8730bec9cc57de05b3b9f1e3de9c42a2.css" integrity="sha256-6uGZJlINbxgJj5Zg54cZG4cwvsnMV94Fs7nx496cQqI=" crossorigin="anonymous"></head><body><nav class="navbar navbar-expand-lg navbar-dark bg-dark" id="farsaran-header-nav"><div class="container"><a class="navbar-brand order-0 flex-grow-1 flex-lg-grow-0" href="/"><img src="/logo.svg" alt="وبلاگ رسمی احمد حجازی" height="34"></a>
<button class="navbar-toggler order-2 order-lg-1" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="نمایش منو">
<span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse mb-3 mb-lg-0" id="navbarSupportedContent"><ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item"><a class="nav-link" href="/contact/">تماس</a></li><li class="nav-item"><a class="nav-link" href="/about/">درباره</a></li></ul></div><script async src="https://cse.google.com/cse.js?cx=929a8d3c0fdb44711">
    </script><div class="gcse-search"></div><style>.gsc-control-cse{padding:0}.gsc-input tbody,.gsc-input input{background-color:#ddd}.gsc-input td.gsib_a{padding:.1rem .5rem}.gsc-search-button{display:none}</style></div></nav><div class="container mt-4"><div class="row"><div class="col-md-9"><header><h1 class="post-title fw-bold fs-2"><a class="text-dark" href="/posts/1390/06/%D8%A8%D8%A7%D8%B2-%DA%A9%D8%B1%D8%AF%D9%86-%D9%81%D8%A7%DB%8C%D9%84-%D9%87%D8%A7-%D8%AF%D8%B1-vbscript/">باز کردن فایل ها در VBScript</a></h1></header><small class="d-block text-secondary post-date">ارسال شده در
<time datetime="2011-09-16">Sep 16, 2011</time></small><article class="blog-post" role="article" typeof="schema:Article"><p>برای این که بخواهیم با یک فایل کار کنیم و محتویات آن را بخوانیم یا محتویات خودمان را در آن بنویسیم و &mldr;، باید ابتدا فایل را باز کنیم.<br>باز کردن فایل در برنامه نویسی به این معناست که از سیستم عامل (و فایل سیستم) برای دسترسی به فایل اجازه می گیریم و در صورتی که اجازه دهد، یک آبجکت استریم برای دسترسی به فایل به دست می آوریم.<br>باز کردن فایل روش ها و اصطلاحات خاصی دارد که در ادامه ی مطلب به آن ها می پردازیم.</p><h2 id="باز-کردن-فایل-متنی-با-متد-opentextfile">باز کردن فایل متنی با متد OpenTextFile</h2><p>متد OpenTextFile از <a href="/tutorials/books/page-15.html" title="آبجکت FileSystemObject یا Fso">آبجکت FileSystemObject</a> ، کار باز کردن فایل های متنی را انجام می دهد. طریقه ی فراخوانی این متد به صورت زیر است:</p><p>Set f = <a href="/tutorials/books/page-15.html">Fso</a>.OpenTextFile(Name, Mode, Create, Format)</p><p>تابع OpenTextFile چهار تا آرگومان میگیرد. سه تای آخر اختیاری است. (اگر از یکی از آن ها استفاده شود، بقیه نیز باید استفاده شوند)</p><ol><li>Name<br>مسیر فایلی که قرار است باز شود. این یک مسیر فیزیکی (مطلق) است.</li><li>Mode<br>برای این آرگومان سه تا مقدار وجود دارد. باید یکی از این ها را استفاده کنید:<ul><li><strong>1</strong> - <a href="/tutorials/books/page-21.html" title="خواندن فایل ها در VBScript">برای خواندن فایل را باز می کند</a>. به این ترتیب می توانید محتویات فایل را بخوانید.</li><li><strong>2</strong> - <a href="/tutorials/books/page-22.html" title="نوشتن در فایل ها در VBScript">برای نوشتن فایل را باز می کند</a>. به این ترتیب می توانید در فایل بنویسید.</li><li><strong>8</strong> - <a href="/tutorials/books/page-23.html" title="افزودن متن به انتهای فایل ها در VBScript">برای اضافه کردن فایل را باز می کند</a>. به این ترتیب می توانید فایل را باز کنید و در انتهای فایل متن مورد نظرتان را اضافه کنید.</li></ul></li><li>Create<br>مقدار این آرگومان True یا False است.<br>در صورتی که فایلی که در آرگومان اول (Name) مشخص شده، پیدا نشود، و این آرگومان True باشد، یک فایل خالی در مسیر مشخص شده ایجاد می شود و باز می شود.<br>در صورتی که این آرگومان False باشد، و فایلی که در Name مشخص شده پیدا نشود، یک خطا ایجاد می شود.<br>مقدار پیش فرض این آرگومان False است.</li><li>Format<br>فرمت فایل را مشخص می کند. سه تا مقدار برای این آرگومان قابل قبول است:<ul><li><strong>صفر</strong> - یعنی فایل به صورت اسکی (ASCII) باز شود.</li><li><strong>1</strong> - یعنی فایل به صورت یونیکد (Unicode) باز شود.</li><li><strong>2</strong> - یعنی از تنظیمات پیش فرض سیستم استفاده شود.</li></ul></li></ol><h3 id="مقدار-بازگشتی-تابع">مقدار بازگشتی تابع</h3><p>مقدار بازگشتی تابع یک Instance (وهله) به فایل باز شده (یا ایجاد شده و باز شده) است. یک Instance از نوع Text Stream<br>به کمک آن می توان در فایل نوشت، خواند، و یا به آن اضافه کرد.</p><p>نکته:<br>معمولا برای راحتی کار تعدادی ثابت را تعریف می کنند تا ارسال آرگومان دوم آسان تر صورت گیرد.</p><p>Const ForReading = 1<br>Const ForWriting = 2<br>Const ForAppending = 8</p><h2 id="باز-کردن-فایل-متنی-به-کمک-متد-openastextstream">باز کردن فایل متنی به کمک متد OpenAsTextStream</h2><p>اگر متغیر objFile یک نمونه از <a href="/tutorials/books/page-17.html" title="ایجاد آبجکت فایل با متد GetFile">آبجکت File</a> باشد، که آن را ساخته ایم، حال چنانچه بخواهیم آن فایل را باز کنیم، از مند OpenAsTextStream استفاده می کنیم. این متد متعلق به آبجکت فایل است (متعلق به Fso نیست).<br>طرز فراخوانی این متد به صورت زیر است:</p><p>Set objOpenFile = objFile.OpenAsTextStream(Mode, Format)</p><p>این تابع دو تا آرگومان می گیرد. Mode و Format که مثل تابع OpenTextFile است که در بالا توضیح داده شد.</p><p><em>نکته</em>:<br>دو تا آرگومان Name و Create در این تابع وجود ندارند. زیرا ما قبلا یک آبجکت File را داشته ایم. نام فایل که مشخص است و مسلما فایل نیز از قبل موجود است چرا که اگر موجود نبود که نمی توانستیم یک آبجکت فایل برای آن فایل داشته باشیم. پس آرگومالن create هم لازم نیست.</p><h3 id="مقدار-بازگشتی-تابع-1">مقدار بازگشتی تابع</h3><p>مانند تابع OpenTextFile است که در بالا توضیح داده شد.</p><h5>مطالب مرتبط:</h5><ul><li><a href="/posts/1390/06/%D8%A7%DB%8C%D8%AC%D8%A7%D8%AF-%D9%81%D8%A7%DB%8C%D9%84-%D9%87%D8%A7-%D8%AF%D8%B1-vbscript/">ایجاد فایل ها در VBScript</a></li><li><a href="/posts/1390/06/%D9%BE%DB%8C%D8%AF%D8%A7-%DA%A9%D8%B1%D8%AF%D9%86-%D9%81%D8%A7%DB%8C%D9%84-%D9%87%D8%A7%DB%8C-%D8%A8%D8%B2%D8%B1%DA%AF-%D8%AA%D8%B1-%D8%A7%D8%B2-100-%DA%A9%DB%8C%D9%84%D9%88-%D8%A8%D8%A7%DB%8C%D8%AA/">پیدا کردن فایل های بزرگ تر از 100 کیلو بایت</a></li></ul></article><div id="comments"><div class="commends-header"><h3>نظرات شما</h3><small class="text-muted" style="font-size:.7rem">قسمت نظرات با استفاده از سرویس <a href="https://disqus.com/">دیسکاس</a> پیاده سازی شده است.
متاسفانه این سرویس از داخل ایران قابل دسترس نیست. لطفا از آی پی خارجی استفاده کنید.</small></div><div id="disqus_thread"></div><script>
        window.disqus_config = function () { 
          this.language = "fa";
        };
        (function() {
            var d = document, s = d.createElement('script'); s.async = true;
            s.src = '//' + "hejazee" + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
      </script></div></div><aside class="col-md-3 mt-4"><h3>Monthly Archive</h3><ul><li><a href="/month/1401-06/" title="All posts from 1401-06">1401-06</a> (1)</li><li><a href="/month/1395-06/" title="All posts from 1395-06">1395-06</a> (1)</li><li><a href="/month/1395-01/" title="All posts from 1395-01">1395-01</a> (1)</li><li><a href="/month/1394-12/" title="All posts from 1394-12">1394-12</a> (3)</li><li><a href="/month/1394-08/" title="All posts from 1394-08">1394-08</a> (1)</li><li><a href="/month/1394-07/" title="All posts from 1394-07">1394-07</a> (1)</li><li><a href="/month/1394-03/" title="All posts from 1394-03">1394-03</a> (1)</li><li><a href="/month/1394-02/" title="All posts from 1394-02">1394-02</a> (1)</li><li><a href="/month/1393-12/" title="All posts from 1393-12">1393-12</a> (1)</li><li><a href="/month/1393-07/" title="All posts from 1393-07">1393-07</a> (1)</li><li><a href="/month/1393-06/" title="All posts from 1393-06">1393-06</a> (2)</li><li><a href="/month/1393-05/" title="All posts from 1393-05">1393-05</a> (2)</li><li><a href="/month/1393-04/" title="All posts from 1393-04">1393-04</a> (4)</li><li><a href="/month/1393-03/" title="All posts from 1393-03">1393-03</a> (5)</li><li><a href="/month/1393-02/" title="All posts from 1393-02">1393-02</a> (1)</li><li><a href="/month/1393-01/" title="All posts from 1393-01">1393-01</a> (4)</li><li><a href="/month/1392-12/" title="All posts from 1392-12">1392-12</a> (5)</li><li><a href="/month/1392-10/" title="All posts from 1392-10">1392-10</a> (5)</li><li><a href="/month/1392-06/" title="All posts from 1392-06">1392-06</a> (1)</li><li><a href="/month/1392-04/" title="All posts from 1392-04">1392-04</a> (1)</li><li><a href="/month/1392-02/" title="All posts from 1392-02">1392-02</a> (1)</li><li><a href="/month/1392-01/" title="All posts from 1392-01">1392-01</a> (5)</li><li><a href="/month/1391-11/" title="All posts from 1391-11">1391-11</a> (5)</li><li><a href="/month/1391-10/" title="All posts from 1391-10">1391-10</a> (4)</li><li><a href="/month/1391-09/" title="All posts from 1391-09">1391-09</a> (2)</li><li><a href="/month/1391-08/" title="All posts from 1391-08">1391-08</a> (3)</li><li><a href="/month/1391-07/" title="All posts from 1391-07">1391-07</a> (6)</li><li><a href="/month/1391-05/" title="All posts from 1391-05">1391-05</a> (1)</li><li><a href="/month/1391-04/" title="All posts from 1391-04">1391-04</a> (1)</li><li><a href="/month/1391-03/" title="All posts from 1391-03">1391-03</a> (2)</li><li><a href="/month/1391-02/" title="All posts from 1391-02">1391-02</a> (4)</li><li><a href="/month/1391-01/" title="All posts from 1391-01">1391-01</a> (6)</li><li><a href="/month/1390-12/" title="All posts from 1390-12">1390-12</a> (9)</li><li><a href="/month/1390-11/" title="All posts from 1390-11">1390-11</a> (8)</li><li><a href="/month/1390-10/" title="All posts from 1390-10">1390-10</a> (7)</li><li><a href="/month/1390-09/" title="All posts from 1390-09">1390-09</a> (4)</li><li><a href="/month/1390-08/" title="All posts from 1390-08">1390-08</a> (7)</li><li><a href="/month/1390-07/" title="All posts from 1390-07">1390-07</a> (15)</li><li><a href="/month/1390-06/" title="All posts from 1390-06">1390-06</a> (18)</li></ul></aside></div></div><footer id="footer-wrapper"><div id="footer-bottom-wrapper"><div class="container"><div class="row"><div class="col-12"><p dir="ltr">&copy; Copyright 2011-2022 * Ahmad Hejazee * All rights reserved.</p><small dir="ltr">Proudly Powered by Drupal 10 ;)</small></div></div></div></div></footer><script src="/lib/jQuery/jquery-3.6.0.min.js"></script>
<script src="/lib/bootstrap-5.1.3-dist/js/bootstrap.bundle.min.js"></script></body></html>