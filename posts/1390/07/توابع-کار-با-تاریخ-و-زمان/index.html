<!doctype html><html lang="fa" dir="rtl"><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-HTH8HV1F9Z"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-HTH8HV1F9Z', { 'anonymize_ip': false });
}
</script><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="geo.region" content="IRAN"><link rel="canonical" href="https://hejazee.ir/posts/1390/07/%D8%AA%D9%88%D8%A7%D8%A8%D8%B9-%DA%A9%D8%A7%D8%B1-%D8%A8%D8%A7-%D8%AA%D8%A7%D8%B1%DB%8C%D8%AE-%D9%88-%D8%B2%D9%85%D8%A7%D9%86/"><link rel="shortcut icon" href="/favicon.ico" type="image/png"><title>توابع کار با تاریخ و زمان | وبلاگ رسمی احمد حجازی</title><link rel="stylesheet" href="/lib/bootstrap-5.1.3-dist/css/bootstrap.rtl.min.css"><link rel="stylesheet" href="/lib/fontawesome-free-5.15.2-web/css/all.min.css"><link rel="stylesheet" href="/fonts/fonts.css"><link rel="stylesheet" href="/scss/index.172bdd1266bb92eb39450b3215cc97ecd4d7ec43ae649679fe3140f189d01c32.css" integrity="sha256-FyvdEma7kus5RQsyFcyX7NTX7EOuZJZ5/jFA8YnQHDI=" crossorigin="anonymous"></head><body><nav class="navbar navbar-expand-lg navbar-dark bg-dark" id="farsaran-header-nav"><div class="container"><a class="navbar-brand order-0 flex-grow-1 flex-lg-grow-0" href="/"><img src="/logo.svg" alt="وبلاگ رسمی احمد حجازی" height="34"></a>
<button class="navbar-toggler order-2 order-lg-1" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="نمایش منو">
<span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse mb-3 mb-lg-0" id="navbarSupportedContent"><ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item"><a class="nav-link" href="/contact/">تماس</a></li><li class="nav-item"><a class="nav-link" href="/about/">درباره</a></li></ul></div></div></nav><div class="container mt-4"><div class="row"><div class="col-md-9"><header><h1 class="post-title fw-bold fs-2"><a class="text-dark" href="/posts/1390/07/%D8%AA%D9%88%D8%A7%D8%A8%D8%B9-%DA%A9%D8%A7%D8%B1-%D8%A8%D8%A7-%D8%AA%D8%A7%D8%B1%DB%8C%D8%AE-%D9%88-%D8%B2%D9%85%D8%A7%D9%86/">توابع کار با تاریخ و زمان</a></h1></header><small class="d-block text-secondary post-date">ارسال شده در
<time datetime="2011-10-05">Oct 5, 2011</time></small><article class="blog-post" role="article" typeof="schema:Article"><h2>ساختن تاریخ با متغیر های روز، ماه و سال</h2><p>اگر روز در متغیر iDateVar ، و ماه در متغیر iMonthVar ، ذخیره شده باشند، نمی توان عبارتی مانند</p><p dir="ltr">#iMonthVar/iDateVar/99#</p><p dir="rtl">یا مشابه آن را به کار برد.</p><p dir="rtl">تابع DateSerial() ، یک سال و ماه و روز را به عنوان آرگومان می گیرد و آن ها را با هم در داخل یک متغیر از نوع Date برمیگرداند.<br>بدیهی است که در این روش، سال، ماه، و روز می توانند به صورت متغیر، مقادیر تعیین شده و یا عبارت باشند.</p><p dir="ltr">dtImportantDate = DateSerial(67, 5, iDayVar)</p><p dir="rtl">&nbsp;مثال فوق، یک تاریخ شامل روز iDayVar ، ماه می (5)، و سال 1967 را در متغیر dtImportantDate ذخیره می کند.</p><p style="border-style:solid;border-width:thin;border-color:#000" dir="ltr"><strong><span style="font-size:large;color:orange">DateSerial ( Year, Month, Day)</span></strong></p><p>مثلا عبارت زیر مقدار #4/28/99# را برمیگردند (به عبارت دیگر، سه روز قبل از اول می 1999)</p><p dir="ltr">DateSerial (99, 5, 1 - 3)</p><h2 dir="rtl">ساختن زمان با متغیر های ساعت، دقیقه، و ثانیه</h2><p>این کار به کمک تابع TimeSerial انجام می شود.</p><p style="border-style:solid;border-width:thin;border-color:#000" dir="ltr"><strong><span style="font-size:large;color:orange">TimeSerial(Hour, Minute, Second)</span></strong></p><p>عبارت زیر، مقدار 2:54:40 AM را برمیگرداند. یعنی 5 دقیقه و 20 ثانیه قبل از ساعت 3 بامداد.</p><p dir="ltr">TimeSerial("3", 0 - 5, 0 - 20)</p><p dir="rtl">عبارت TimeSerial(5, 3, 29) ساعت 5 و سه دقیقه و بیست و نه ثانیه را برمیگرداند.</p><h2 dir="rtl">تابع Timer</h2><p>همان طور که قبلا هم گفتم، این تابع تعداد ثانیه هایی که از نیمه شب تا اکنون گذشته است را برمیگرداند.<br>این تابع، برای تعیین کردن مقدار زمانی که اجرا شدن یک قطعه کد می گیرد، می تواند مفید باشد.</p><p dir="ltr">iSartTime = Timer<br>'Code to determine its execution time....<br>iEndTime = Tmer<br>iSecondsElapsed = iEndTime - iStartTime</p><h2 dir="rtl">به دست آوردن روز، ماه، و سال و ... از روی متغیر date</h2><p>فرض کنید یک متغیر از نوع Date داریم. می خواهیم بدانیم که این متغیر به چه روزی یا به چه سالی اشاره می کند. برای این منظور، از تابع DatePart استفاده می کنیم.</p><p style="border-style:solid;border-width:thin;border-color:#000" dir="ltr"><strong><span style="font-size:large;color:orange">DatePart(InterVal, dtDate, firstDayOfWeek, firstWeekOfYear)</span></strong></p><p>&nbsp;1 - آرگومان اول این تابع (Interval)، یک رشته است و مشخص می کند که چه چیزی را از تاریخ می خواهیم استخراج کنیم. مقادیر مورد قبول عبارتند از:<br><a name="interval_table"></a></p><table style="border:1px solid blue"><caption><span style="font-size:medium"><strong>جدول مقادیر InterVal</strong></span></caption><tbody><tr><td>"yyyy"</td><td>سال</td></tr><tr><td>"q"</td><td>ربع (ربع ساعت)</td></tr><tr><td>"m"</td><td>ماه</td></tr><tr><td>"y"</td><td>چندمین روز از سال</td></tr><tr><td>"d</td><td>چندمین روز از ماه</td></tr><tr><td>"w"</td><td>روز هفته</td></tr><tr><td>"ww"</td><td>چندمین هفته ی سال</td></tr><tr><td>"h"</td><td>ساعت</td></tr><tr><td>"n"</td><td>دقیقه</td></tr><tr><td>"s"</td><td>ثانیه</td></tr></tbody></table><p>2 - آرگومان دوم (dtDate)، تاریخی است که می خواهیم اجزا آن را استخراج کنیم.</p><p>&nbsp;3 - آرگومان سوم (firstDayOfWeek)، اختیاری است و اجازه می دهد که مشخص کنیم برای محاسبه، روز اول هفته را مطابق میل خود تنظیم کنیم. این کار، هنگام استفاده از آرگومان InterVal با مقدار "w" یا "ww" مفید است. مقادیر قابل قبول برای firstDayOfWeek، یک سری ثوابت از پیش تعریف شده هستند.</p><table style="border:1px solid blue"><caption><span style="font-size:medium"><strong>جدول ثوابت مربوط به روز های هفته</strong></span></caption><tbody><tr><td>&nbsp;vbUseSystem = 0</td><td>&nbsp;National Language Support API Setting</td></tr><tr><td>&nbsp;vbSunday = 1</td><td>&nbsp;یکشنبه (پیش فرض)</td></tr><tr><td>&nbsp;vbMonday = 2</td><td>&nbsp;دوشنبه</td></tr><tr><td>&nbsp;vbTuesday = 3</td><td>&nbsp;سه شنبه</td></tr><tr><td>&nbsp;vbWednesday = 4</td><td>&nbsp;چهارشنبه</td></tr><tr><td>&nbsp;vbThursday = 5</td><td>&nbsp;پنج شنبه</td></tr><tr><td>&nbsp;vbFriday = 6</td><td>&nbsp;جمعه</td></tr><tr><td>&nbsp;vbSaturday = 7</td><td>&nbsp;شنبه</td></tr></tbody></table><p>4 - آرگومان چهارم (firstWeekOfYear) نیز اختیاری است. و اجازه می دهد اولین هفته ی سال را تعیین کنیم. مقادیر مجاز آن در جدول زیر نوشته شده است:</p><table style="border:1px solid blue"><caption><span style="font-size:medium"><strong>جدول ثابت های مربوط به اولین هفته ی سال</strong></span></caption><tbody><tr><td>&nbsp;vbUseSystem</td><td>&nbsp;استفاده از تنظیمات سیستم</td></tr><tr><td>&nbsp;vbFirstJan1</td><td>&nbsp;هفته ی اول ژانویه</td></tr><tr><td>&nbsp;vbFirstFourDays</td><td>&nbsp;چهار روز اولین هفته ی سال جدید</td></tr><tr><td>&nbsp;vbFirstFullWeek</td><td>&nbsp;روز اول تمامی هفته ها</td></tr></tbody></table><p><span style="font-size:medium;color:#396;font-weight:700">چند مثال:</span></p><p dir="ltr">DatePart("m", #9/17/67#)</p><p dir="rtl">مقدار 9 را برمیگرداند که نشان دهنده ی سپتامبر - ماه نهم سال - است.</p><p dir="ltr">DatePart("y", #9/21/96#)</p><p dir="rtl">مقدار 265 را برمی گرداند که نشان می دهد تا 21 سپتامبر، 265 روز از سال گذشته است.</p><p dir="ltr">DatePart("w", #9/18/99#, 3)</p><p dir="rtl">یعنی روز اول هفه را سه شنبه در نظر گرفته ایم. و چون طبق تقویم، 9/18/99 شنبه بوده، پس عدد 5 را برمیگرداند.</p><p dir="ltr">DatePart("w", #9/18/99#, 6)</p><p dir="rtl">عدد 2 برگردانده می شود. عدد 6 نشان می دهد که جمعه را به عنوان روز اول هفته در نظر گرفته ایم.</p><p dir="ltr">DatePart("ww", #9/18/99#, 2, 1)</p><p dir="rtl">یعنی دوشنبه به عنوان روز اول هفته و اول ژانویه به عنوان اولین هفته ی سال در نظر گرفته شده است.</p><p dir="rtl">&nbsp;</p><h2 dir="rtl">روش های دیگر برای استخراج روز، ماه، و ... از تاریخ</h2><p>1 - تابع&nbsp; Year یک تاریخ را میگیرد و سال مربوط به آن را به صورت عدد صحیح برمیگرداند.</p><p>2 - تابع Month یک تاریخ را میگیرد و ماه مربوط به آن را به صورت عدد صحیح برمیگرداند.</p><p>3 - تابع MonthName</p><p style="border-style:solid;border-width:thin;border-color:#000" dir="ltr"><strong><span style="font-size:large;color:orange">MonthName (MonthNumber, Abbrev)<br></span></strong></p><p>این تابع یک رشته شامل نام ماه برمیگرداند. آرگومان های آن به قرار زیر است:</p><ol><li>آرگومان اول (MonthNumber) یک عدد صحیح بین 1 تا 12 است (شماره ی ماه)</li><li>آرگومان دوم (Abbrev) یک آرگومان اختیاری است که اگر False باشد، نام ماه به طور کامل، و اگر True باشد، نام ماه به صورت اختصاری برگردانده می شود. در حالت پیش فرض False است. یعنی در حالت پیش فرض نام ماه به طور کامل برگردانده می شود.</li></ol><p>مثال:</p><p dir="ltr">MonthName (11)</p><p dir="rtl">مقدار رشته ای "November" را برمیگرداند.</p><p dir="ltr">MonthName(11, True)</p><p dir="rtl">مقدار رشته ای "Nov" را برمیگرداند.</p><p dir="rtl">4 - تابع day() بخش روز یک تاریخ را به صورت عدد صحیح برمیگرداند.</p><p dir="rtl">5 - تابع WeekDay مشخص می کند که تاریخ فوق، روز چندم از هفته است.</p><p dir="rtl">6 - تابع Hour یک زمان را به عنوان آرگومان می گیرد و بخش ساعت آن را بر میگرداند</p><p dir="rtl">7 - تابع Minute بخش دقیقه ی یک زمان را برمیگرداند.</p><p dir="rtl">8 - تابع Second بخش ثانیه ی مربوط به یک زمان را برمیگرداند.</p><p dir="rtl">&nbsp;</p><fieldset><legend>نکته ی انحرافی 1</legend><div>شاید این جا جای این نکته نباشد، اما به هر حال لازم است که بدانید فرمت تاریخ های میلادی به چه صورت است.</div><div>وقتی می نویسیم 9/18/99 یعنی 18 نوامبر سال 1999. فرمت تاریخ های میلادی به صورت زیر است:</div><div style="text-align:center;width:200px;padding:5px;border-style:solid;border-width:thin;border-color:#000;margin:0 auto"><strong>سال / روز / ماه</strong></div>می توان سال را حذف کرد. مثلا 9/18 هیجدهم نوامبر را مشخص می کند: <strong>روز / ماه</strong></fieldset><fieldset><legend>نکته ی انحرافی 2</legend><div>ممکن است به یاد داشته باشید که برای رجوع به یک تاریخ معین، آن را در داخل دو علامت # قرار می دادیم. وقتی با این توابع کار می کنید ممکن است سال را حذف کنید و اجازه دهید که سیستم سال فعلی را در نظر بگیرد.<br>اگر چنین قصدی دارید، تاریخ را بین دو علامت کوتیشن قرار دهید. برای مثال تاریخ #9/18/99# وقتی به کار می رود که شما مخصوصا به تاریخ 18 نوامبر <span style="text-decoration:underline">سال 1999</span> تاکید دارید. اگر به جای آن، 18 نوامبر سال جاری را در نظر دارید، باید تاریخ را به فرمت "9/18" بنویسید.<br>با این کار، کد شما به صورت خودکار در هر سال کار خواهد کرد و لازم نمی شود که هر سال آن را تغییر دهید.</div></fieldset><h2>افزودن به یک تاریخ با تابع DateAdd</h2><p style="border-style:solid;border-width:thin;border-color:#000" dir="ltr"><strong><span style="font-size:large;color:orange">DateAdd (interval, number, date)<br></span></strong></p><p>اگر یک تاریخ را داشته باشیم و بخواهیم تاریخ یک ماه یا یک روز یا 5 سال بعد را بفهمیم، از این تابع استفاده می کنیم.</p><p>(خبر خوشحال کننده این است که تمامی توابع تاریخ VBScript به صورت درونی از استثنا های تاریخی مثل سال های کبیسه و یا ماه هایی که تعداد روز هایشان متفاوت است، پشتیبانی می کنند. اگر شما می خواستید بدون استفاده از این توابع، محاسبان تاریخی انجام دهید، قابل تصور است که چقدر کارتان سخت و دشوار می شد.)</p><p>در تابع DateAdd، آرگومان اول (interval) مشخص می کند که می خواهیم به کدام مؤلفه ی تاریخ بیافزاییم. مثلا می خواهیم به روز اضافه کنیم یا به ماه یا به سال یا ... . مقادیر این آرگومان در <a href="#interval_table">جدول مقادیر interval</a> آمده است.</p><p dir="rtl">آرگومان دوم (Number) هم مشخص می کند که چند واحد می خواهیم به مؤلفه یInterval &nbsp;اضافه کنیم. (چند تا Interval &nbsp;می خواهیم به تاریخ اضافه کنیم)</p><p dir="rtl">آرگومان سوم (date) هم تاریخ مورد نظر است که می خواهیم به آن مقداری را اضافه کنیم.</p><p dir="rtl">مثلا DateAdd(“m”, 1, #12/7/90#) مشخص می کند که می خواهیم با تاریخ 12/7/90 یک ماه بیافزاییم که می شود 13/7/90</p><p dir="rtl"><strong>مثال ها</strong></p><p dir="ltr"><span style="font-size:11pt;line-height:115%;font-family:calibri,sans-serif">DateAdd(“m”, 1, #12/7/90#)<span>&nbsp;&nbsp; </span>--------------------</span><span style="font-size:11pt;line-height:115%;font-family:Wingdings"><span>></span></span><span style="font-size:11pt;line-height:115%;font-family:calibri,sans-serif"> 1/7/91<br>DateAdd(“d”, 1, Date)<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>-------------------</span><span style="font-size:11pt;line-height:115%;font-family:Wingdings"><span>></span></span><span style="font-size:11pt;line-height:115%;font-family:calibri,sans-serif"> </span><span style="font-size:11pt;line-height:115%;font-family:arial,sans-serif">روز بعد (فردا)</span><span style="font-size:11pt;line-height:115%;font-family:calibri,sans-serif"><br>DateAdd(“yyyy”, 5, #2/7/88#)<span>&nbsp; </span>-------------------</span><span style="font-size:11pt;line-height:115%;font-family:Wingdings"><span>></span></span><span style="font-size:11pt;line-height:115%;font-family:calibri,sans-serif"><span>&nbsp; </span>2/7/93<br>DateAdd()<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>--------------------------------</span><span style="font-size:11pt;line-height:115%;font-family:Wingdings"><span>></span></span><span style="font-size:11pt;line-height:115%;font-family:calibri,sans-serif"> </span><span style="font-size:11pt;line-height:115%;font-family:arial,sans-serif">بدون آرگومان چیزی را برنمی گرداند</span><span style="font-size:11pt;line-height:115%;font-family:calibri,sans-serif"><br>DateAdd(“m”, 1, #8/31/99#) ---------------------</span><span style="font-size:11pt;line-height:115%;font-family:Wingdings"><span>></span></span><span style="font-size:11pt;line-height:115%;font-family:calibri,sans-serif"> 9/31/99</span></p><p dir="rtl"><span style="font-size:11pt;line-height:115%;font-family:calibri,sans-serif"><br></span></p><h5>مطالب مرتبط:</h5><ul><li></li><li><a href="/posts/1390/07/%D8%AA%D9%88%D8%A7%D8%A8%D8%B9-%D9%82%D8%A7%D9%84%D8%A8-%D8%A8%D9%86%D8%AF%DB%8C-%D8%AA%D8%A7%D8%B1%DB%8C%D8%AE/">توابع قالب بندی تاریخ</a></li></ul></article></div><aside class="col-md-3 mt-4"><h3>Monthly Archive</h3><ul><li><a href="/month/1401-06/" title="All posts from 1401-06">1401-06</a> (1)</li><li><a href="/month/1395-06/" title="All posts from 1395-06">1395-06</a> (1)</li><li><a href="/month/1395-01/" title="All posts from 1395-01">1395-01</a> (1)</li><li><a href="/month/1394-12/" title="All posts from 1394-12">1394-12</a> (3)</li><li><a href="/month/1394-08/" title="All posts from 1394-08">1394-08</a> (1)</li><li><a href="/month/1394-07/" title="All posts from 1394-07">1394-07</a> (1)</li><li><a href="/month/1394-03/" title="All posts from 1394-03">1394-03</a> (1)</li><li><a href="/month/1394-02/" title="All posts from 1394-02">1394-02</a> (1)</li><li><a href="/month/1393-12/" title="All posts from 1393-12">1393-12</a> (1)</li><li><a href="/month/1393-07/" title="All posts from 1393-07">1393-07</a> (1)</li><li><a href="/month/1393-06/" title="All posts from 1393-06">1393-06</a> (2)</li><li><a href="/month/1393-05/" title="All posts from 1393-05">1393-05</a> (2)</li><li><a href="/month/1393-04/" title="All posts from 1393-04">1393-04</a> (4)</li><li><a href="/month/1393-03/" title="All posts from 1393-03">1393-03</a> (5)</li><li><a href="/month/1393-02/" title="All posts from 1393-02">1393-02</a> (1)</li><li><a href="/month/1393-01/" title="All posts from 1393-01">1393-01</a> (4)</li><li><a href="/month/1392-12/" title="All posts from 1392-12">1392-12</a> (5)</li><li><a href="/month/1392-10/" title="All posts from 1392-10">1392-10</a> (5)</li><li><a href="/month/1392-06/" title="All posts from 1392-06">1392-06</a> (1)</li><li><a href="/month/1392-04/" title="All posts from 1392-04">1392-04</a> (1)</li><li><a href="/month/1392-02/" title="All posts from 1392-02">1392-02</a> (1)</li><li><a href="/month/1392-01/" title="All posts from 1392-01">1392-01</a> (5)</li><li><a href="/month/1391-11/" title="All posts from 1391-11">1391-11</a> (5)</li><li><a href="/month/1391-10/" title="All posts from 1391-10">1391-10</a> (4)</li><li><a href="/month/1391-09/" title="All posts from 1391-09">1391-09</a> (2)</li><li><a href="/month/1391-08/" title="All posts from 1391-08">1391-08</a> (3)</li><li><a href="/month/1391-07/" title="All posts from 1391-07">1391-07</a> (6)</li><li><a href="/month/1391-05/" title="All posts from 1391-05">1391-05</a> (1)</li><li><a href="/month/1391-04/" title="All posts from 1391-04">1391-04</a> (1)</li><li><a href="/month/1391-03/" title="All posts from 1391-03">1391-03</a> (2)</li><li><a href="/month/1391-02/" title="All posts from 1391-02">1391-02</a> (4)</li><li><a href="/month/1391-01/" title="All posts from 1391-01">1391-01</a> (6)</li><li><a href="/month/1390-12/" title="All posts from 1390-12">1390-12</a> (9)</li><li><a href="/month/1390-11/" title="All posts from 1390-11">1390-11</a> (8)</li><li><a href="/month/1390-10/" title="All posts from 1390-10">1390-10</a> (7)</li><li><a href="/month/1390-09/" title="All posts from 1390-09">1390-09</a> (4)</li><li><a href="/month/1390-08/" title="All posts from 1390-08">1390-08</a> (7)</li><li><a href="/month/1390-07/" title="All posts from 1390-07">1390-07</a> (14)</li><li><a href="/month/1390-06/" title="All posts from 1390-06">1390-06</a> (18)</li></ul></aside></div></div><footer id="footer-wrapper"><div id="footer-bottom-wrapper"><div class="container"><div class="row"><div class="col-12"><p dir="ltr">&copy; Copyright 2011-2022 * Ahmad Hejazee * All rights reserved.</p><small dir="ltr">Proudly Powered by Drupal 10 ;)</small></div></div></div></div></footer><script src="/lib/jQuery/jquery-3.6.0.min.js"></script>
<script src="/lib/bootstrap-5.1.3-dist/js/bootstrap.bundle.min.js"></script></body></html>