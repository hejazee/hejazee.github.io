<!doctype html><html lang="fa" dir="rtl"><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-HTH8HV1F9Z"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-HTH8HV1F9Z', { 'anonymize_ip': false });
}
</script><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="geo.region" content="IRAN"><link rel="canonical" href="https://hejazee.ir/posts/1390/07/%DA%A9%D8%A7%D8%B1-%DA%A9%D8%B1%D8%AF%D9%86-%D8%A8%D8%A7-%D8%A2%D8%B1%DA%AF%D9%88%D9%85%D8%A7%D9%86-%D9%87%D8%A7%DB%8C-%D8%AE%D8%B7-%D9%81%D8%B1%D9%85%D8%A7%D9%86-%D8%AF%D8%B1-vbscript/"><link rel="shortcut icon" href="/favicon.ico" type="image/png"><title>کار کردن با آرگومان های خط فرمان در VBScript | وبلاگ رسمی احمد حجازی</title><link rel="stylesheet" href="/lib/bootstrap-5.1.3-dist/css/bootstrap.rtl.min.css"><link rel="stylesheet" href="/lib/fontawesome-free-5.15.2-web/css/all.min.css"><link rel="stylesheet" href="/fonts/fonts.css"><link rel="stylesheet" href="/scss/index.172bdd1266bb92eb39450b3215cc97ecd4d7ec43ae649679fe3140f189d01c32.css" integrity="sha256-FyvdEma7kus5RQsyFcyX7NTX7EOuZJZ5/jFA8YnQHDI=" crossorigin="anonymous"></head><body><nav class="navbar navbar-expand-lg navbar-dark bg-dark" id="farsaran-header-nav"><div class="container"><a class="navbar-brand order-0 flex-grow-1 flex-lg-grow-0" href="/"><img src="/logo.svg" alt="وبلاگ رسمی احمد حجازی" height="34"></a>
<button class="navbar-toggler order-2 order-lg-1" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="نمایش منو">
<span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse mb-3 mb-lg-0" id="navbarSupportedContent"><ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item"><a class="nav-link" href="/contact/">تماس</a></li><li class="nav-item"><a class="nav-link" href="/about/">درباره</a></li></ul></div></div></nav><div class="container mt-4"><div class="row"><div class="col-md-9"><header><h1 class="post-title fw-bold fs-2"><a class="text-dark" href="/posts/1390/07/%DA%A9%D8%A7%D8%B1-%DA%A9%D8%B1%D8%AF%D9%86-%D8%A8%D8%A7-%D8%A2%D8%B1%DA%AF%D9%88%D9%85%D8%A7%D9%86-%D9%87%D8%A7%DB%8C-%D8%AE%D8%B7-%D9%81%D8%B1%D9%85%D8%A7%D9%86-%D8%AF%D8%B1-vbscript/">کار کردن با آرگومان های خط فرمان در VBScript</a></h1></header><small class="d-block text-secondary post-date">ارسال شده در
<time datetime="2011-10-08">Oct 8, 2011</time></small><article class="blog-post" role="article" typeof="schema:Article"><p>[quote]</p><p>یه سوال ؟<br>فرض کنید ما یه برنامه با VBScript نوشتیم بعدش اون رو کامپایلش میکنیم ! (هم با vbsedit میشه هم با ScriptCryptor)<br>آیا امکانش هست که تو VBScript از Command line استفاده کرد؟<br>مثلا" اسم فایل ما Project.exe هست , آیا میشه با دستور زیر یک قطعه کد یا sub به خصوص رو اجرا کرد<br>Project.exe /command</p><p>[/quote]</p><p>زبان WScript در ویندوز به دو طریق می تواند اجرا شود:</p><ol><li>روش اول این است که برنامه را در یک فایل با پسوند vbs ذخیره کنید و سپس فایل را Double Click کنید. در این صورت، فایل توسط برنامه ای به نام Microsoft ® Windows Based Script Host اجرا می شود. نام فایل این برنامه wscript.exe است. در این روش، برنامه به صورت مخفیانه اجرا می شود و فقط از طریق کادر های پیغام گرافیکی (MsgBox, InputBox) می تواند با کاربر ارتباط برقرار کند.</li><li>روش دوم این است که برنامه ی VBScript را در خط فرمان اجرا کنیم. برای این منظور، دیگر از wscript.exe استفاده نمی کنیم. به جای آن از cscript.exe استفاده می کنیم که موتور VBScript در خط فرمان است. در این روش، برنامه ی VBScript می تواند از طریق خط فرمان با کاربر محاوره داشته باشد.</li></ol><p dir="ltr"><span style="font-family:times new roman,times;font-size:medium">cscript C:\path\to\my\script.vbs</span></p><p>در دستور بالا (که باید در CMD اجرا شود) فایل C:\path\to\my\script.vbs توسط برنامه ی cscript در خط فرمان اجرا می شود.</p><p>در این جا، به اجرای برنامه در خط فرمان (روش دوم) می پردازیم.</p><hr><p>هنگامی که می خواهید یک اسکریپت را در خط فرمان اجرا کنید، ممکن است در ادامه ی نام اسکریپت، کلمات دیگری را هم تایپ کنید. به این کلمات اضافی، <em>آرگومان های خط فرمان</em> می گویند.<br>در صورتی که با ابزار های خط فرمانی کار کرده باشید، حتما با آرگومان های خط فرمان آشنایی دارید. به طور مثال برنامه ی Ping.exe یک برنامه ی خط فرمانی است. این برنامه حد اقل به یک آرگومان نیاز دارد که آدرس IP ی کامپیوتر مورد نظر جهت پینگ است:</p><p dir="ltr"><span style="font-size:medium">Ping 4.2.2.4</span></p><p>همان طور که می بینید، 4.2.2.4 در واقع یک آرگومان خط فرمان است که برنامه ی Ping.exe ارسال شده است.</p><p>اسکریپت ها هم می توانند آرگومان خط فرمان داشته باشند. دلیل این است که ممکن است بخواهیم یک اسکریپت یک سری ورودی ها را از کاربر بگیرد و بر اساس آن ها کارش را انجام دهد.<br>مثلا می خواهیم برنامه ای را بنویسیم که دو تا عدد را در خط فرمان دریافت کند و حاصل جمع آن دو تا را در خروجی چاپ کند. یعنی برنامه ی با این صورت اجرا شود:</p><p dir="ltr"><span style="font-size:medium">Add.vbs&nbsp; 5&nbsp; 7</span></p><p>و عدد 12 که حاصل جمع 5 و 7 است را چاپ کند. در مثال فوق، اعداد 5 و 7 به عنوان دو تا آرگومان خط فرمان به Add.vbs ارسال شده اند و در برنامه ی Add.vbs به آن ها دسترسی داریم.</p><blockquote><p><span style="font-size:medium">نکته:</span><br>آرگومان های خط فرمان با یک یا چند space باید از هم جدا شوند. در مثال فوق هم میبینید که بین 5 و 7 یک فاصله وجود دارد. در صورتی که در داخل یک آرگومان، یک فاصله وجود داشته باشد، به عنوان دو تا آرگومان در نظر گرفته می شود. برای جلوگیری از این مسئله، کافی است آرگومان هایی که شامل فاصله هستند را در داخل کوتیشن قرار دهید.</p></blockquote><p>در داخل اسکریپت ما، آرگومان های خط فرمان در درون کلکسیون WshArguments ذخیره شده اند. برای دسترسی به این کلکسیون، باید از خصوصیت Arguments از آبجکت WScript استفاده کرد.<br>این مطلب در شکل زیر به تصویر کشیده شده است:</p><p><img src="http://www.hejazee.com/sites/www.hejazee.com/files/fields/field_tutorial_images/books/u1/WSH.Arguments.gif" alt="تصویر آموزشی" title style="display:block;margin-left:auto;margin-right:auto" height="516" width="519"></p><p>&nbsp;</p><p>بعلاوه، همان طور که میبینید، WSH آرگومان های خط فرمان را، بر اساس فرمت آرگومان، به دو دسته ی WshNamed و WshUnnamed تقسیم بندی می کند.</p><h2>آرگومان های خط فرمان چگونه ذخیره می شوند و چگونه فیلتر و دسته بندی می شوند</h2><p>هنگامی که شما یک اسکریپت را با آرگومان های خط فرمان اجرا میکنید، در داخل اسکریپت از طریق کلکسیون WshArgumentsبه آرگومان های خط فرمان دسترسی دارید.</p><h5>مطالب مرتبط:</h5><ul><li><a href="/posts/1390/06/%D8%A8%D8%B1%D9%86%D8%A7%D9%85%D9%87-%D9%86%D9%88%DB%8C%D8%B3%DB%8C-%D8%B4%DB%8C-%DA%AF%D8%B1%D8%A7-%D8%AF%D8%B1-vbscript/">برنامه نویسی شی گرا در VBScript</a></li><li><a href="/posts/1390/07/%D8%AF%D9%88%D8%B1%D9%87-%DB%8C-%D8%A2%D9%85%D9%88%D8%B2%D8%B4%DB%8C-vbscript-%D8%A7%D8%B2-%D9%85%D8%A8%D8%AA%D8%AF%DB%8C-%D8%AA%D8%A7-%D9%BE%DB%8C%D8%B4%D8%B1%D9%81%D8%AA%D9%87/">دوره ی آموزشی VBScript از مبتدی تا پیشرفته</a></li></ul></article><div id="comments"><div id="disqus_thread"></div><script>
      window.disqus_config = function () { 
        this.language = "fa";
      };
      (function() {
          var d = document, s = d.createElement('script'); s.async = true;
          s.src = '//' + "hejazee" + '.disqus.com/embed.js';
          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
      })();
    </script></div></div><aside class="col-md-3 mt-4"><h3>Monthly Archive</h3><ul><li><a href="/month/1395-06/" title="All posts from 1395-06">1395-06</a> (1)</li><li><a href="/month/1395-01/" title="All posts from 1395-01">1395-01</a> (1)</li><li><a href="/month/1394-12/" title="All posts from 1394-12">1394-12</a> (3)</li><li><a href="/month/1394-08/" title="All posts from 1394-08">1394-08</a> (1)</li><li><a href="/month/1394-07/" title="All posts from 1394-07">1394-07</a> (1)</li><li><a href="/month/1394-03/" title="All posts from 1394-03">1394-03</a> (1)</li><li><a href="/month/1394-02/" title="All posts from 1394-02">1394-02</a> (1)</li><li><a href="/month/1393-12/" title="All posts from 1393-12">1393-12</a> (1)</li><li><a href="/month/1393-07/" title="All posts from 1393-07">1393-07</a> (1)</li><li><a href="/month/1393-06/" title="All posts from 1393-06">1393-06</a> (2)</li><li><a href="/month/1393-05/" title="All posts from 1393-05">1393-05</a> (2)</li><li><a href="/month/1393-04/" title="All posts from 1393-04">1393-04</a> (4)</li><li><a href="/month/1393-03/" title="All posts from 1393-03">1393-03</a> (5)</li><li><a href="/month/1393-02/" title="All posts from 1393-02">1393-02</a> (1)</li><li><a href="/month/1393-01/" title="All posts from 1393-01">1393-01</a> (4)</li><li><a href="/month/1392-12/" title="All posts from 1392-12">1392-12</a> (5)</li><li><a href="/month/1392-10/" title="All posts from 1392-10">1392-10</a> (5)</li><li><a href="/month/1392-06/" title="All posts from 1392-06">1392-06</a> (1)</li><li><a href="/month/1392-04/" title="All posts from 1392-04">1392-04</a> (1)</li><li><a href="/month/1392-02/" title="All posts from 1392-02">1392-02</a> (1)</li><li><a href="/month/1392-01/" title="All posts from 1392-01">1392-01</a> (5)</li><li><a href="/month/1391-11/" title="All posts from 1391-11">1391-11</a> (5)</li><li><a href="/month/1391-10/" title="All posts from 1391-10">1391-10</a> (4)</li><li><a href="/month/1391-09/" title="All posts from 1391-09">1391-09</a> (2)</li><li><a href="/month/1391-08/" title="All posts from 1391-08">1391-08</a> (3)</li><li><a href="/month/1391-07/" title="All posts from 1391-07">1391-07</a> (6)</li><li><a href="/month/1391-05/" title="All posts from 1391-05">1391-05</a> (1)</li><li><a href="/month/1391-04/" title="All posts from 1391-04">1391-04</a> (1)</li><li><a href="/month/1391-03/" title="All posts from 1391-03">1391-03</a> (2)</li><li><a href="/month/1391-02/" title="All posts from 1391-02">1391-02</a> (4)</li><li><a href="/month/1391-01/" title="All posts from 1391-01">1391-01</a> (6)</li><li><a href="/month/1390-12/" title="All posts from 1390-12">1390-12</a> (9)</li><li><a href="/month/1390-11/" title="All posts from 1390-11">1390-11</a> (8)</li><li><a href="/month/1390-10/" title="All posts from 1390-10">1390-10</a> (7)</li><li><a href="/month/1390-09/" title="All posts from 1390-09">1390-09</a> (4)</li><li><a href="/month/1390-08/" title="All posts from 1390-08">1390-08</a> (7)</li><li><a href="/month/1390-07/" title="All posts from 1390-07">1390-07</a> (14)</li><li><a href="/month/1390-06/" title="All posts from 1390-06">1390-06</a> (18)</li></ul></aside></div></div><footer id="footer-wrapper"><div id="footer-bottom-wrapper"><div class="container"><div class="row"><div class="col-12"><p dir="ltr">&copy; Copyright 2011-2022 * Ahmad Hejazee * All rights reserved.</p><small dir="ltr">Proudly Powered by Drupal 10 ;)</small></div></div></div></div></footer><script src="/lib/jQuery/jquery-3.6.0.min.js"></script>
<script src="/lib/bootstrap-5.1.3-dist/js/bootstrap.bundle.min.js"></script></body></html>