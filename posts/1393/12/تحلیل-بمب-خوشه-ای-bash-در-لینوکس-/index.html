<!doctype html><html lang="fa" dir="rtl"><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-HTH8HV1F9Z"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-HTH8HV1F9Z', { 'anonymize_ip': false });
}
</script><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="geo.region" content="IRAN"><link rel="canonical" href="https://hejazee.ir/posts/1393/12/%D8%AA%D8%AD%D9%84%DB%8C%D9%84-%D8%A8%D9%85%D8%A8-%D8%AE%D9%88%D8%B4%D9%87-%D8%A7%DB%8C-bash-%D8%AF%D8%B1-%D9%84%DB%8C%D9%86%D9%88%DA%A9%D8%B3-/"><link rel="shortcut icon" href="/favicon.ico" type="image/png"><title>تحلیل بمب خوشه ای Bash در لینوکس ‎:‎(‎)‎{‎ ‎:‎|‎:‎&‎ ‎}‎;‎:‎ | وبلاگ رسمی احمد حجازی</title><link rel="stylesheet" href="/lib/bootstrap-5.1.3-dist/css/bootstrap.rtl.min.css"><link rel="stylesheet" href="/lib/fontawesome-free-5.15.2-web/css/all.min.css"><link rel="stylesheet" href="/fonts/fonts.css"><link rel="stylesheet" href="/scss/index.172bdd1266bb92eb39450b3215cc97ecd4d7ec43ae649679fe3140f189d01c32.css" integrity="sha256-FyvdEma7kus5RQsyFcyX7NTX7EOuZJZ5/jFA8YnQHDI=" crossorigin="anonymous"></head><body><nav class="navbar navbar-expand-lg navbar-dark bg-dark" id="farsaran-header-nav"><div class="container"><a class="navbar-brand order-0 flex-grow-1 flex-lg-grow-0" href="/"><img src="/logo.svg" alt="وبلاگ رسمی احمد حجازی" height="34"></a>
<button class="navbar-toggler order-2 order-lg-1" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="نمایش منو">
<span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse mb-3 mb-lg-0" id="navbarSupportedContent"><ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item"><a class="nav-link" href="/contact/">تماس</a></li><li class="nav-item"><a class="nav-link" href="/about/">درباره</a></li></ul></div></div></nav><div class="container mt-4"><div class="row"><div class="col-md-9"><header><h1 class="post-title fw-bold fs-2"><a class="text-dark" href="/posts/1393/12/%D8%AA%D8%AD%D9%84%DB%8C%D9%84-%D8%A8%D9%85%D8%A8-%D8%AE%D9%88%D8%B4%D9%87-%D8%A7%DB%8C-bash-%D8%AF%D8%B1-%D9%84%DB%8C%D9%86%D9%88%DA%A9%D8%B3-/">تحلیل بمب خوشه ای Bash در لینوکس ‎:‎(‎)‎{‎ ‎:‎|‎:‎&‎ ‎}‎;‎:‎</a></h1></header><small class="d-block text-secondary post-date">ارسال شده در
<time datetime="2015-02-27">Feb 27, 2015</time></small><article class="blog-post" role="article" typeof="schema:Article"><p>بمب خوشه ای لینوکس به صورت زیر است: اگر دستور زیر را در bash اجرا کنید (فرقی نمی کند لینوکس، یا ویندوز یا هر سیستم عاملی که bash داشته باشد) بعد از گذشت چند لحظه تمام منابع سیستم مصرف شده و به اصطلاح سیستم crash میکند و به هیچ وسیله نمی توانید بمب خوشه ای را متوقف کنید و می بایست سیستم را ریستارت کنید.</p><p>:(){ :|:& };:</p><p><strong>اخطار</strong>: برای اجرای دستور فوق احتیاط کنید زیرا سیستم عامل هنگ کرده و محبور به ریستارت کردن سیستم توسط دکمه ی فیزیکی خواهید شد.</p><p>بمب خوشه ای فوق، یک نوع حمله ی Denial of Service (یا به اختصار DoS) می باشد. این بمب از دستور fork سیستم عامل برای تولید مثل خوشه ای استفاده میکند. (به همین دلیل به آن بمب bash fork گفته می شود)</p><p>دستور  ‎:‎(‎)‎{‎ ‎:‎|‎:‎&‎ ‎}‎;‎:‎ فقط یک تابع bash می باشد که قدری عجیب غریب نوشته شده! در ادامه آن را برای شما شرح می دهم که به طور کامل طرز کار آن را درک کنید.</p><p>تابع فوق، به صورت بازگشتی خودش را فراخوانی میکند. این تابع معمولا توسط مدیران سیستم برای بررسی محدودیت تعداد پروسه ها استفاده می شود. محدودیت تعداد پروسه ها در فایل limits.conf واقع در آدرس /etc/security/limits.conf و همچنین توسط PAM قابل تنظیم می باشد.</p><p><strong>شرح بمب:</strong></p><p> ‎:‎(‎)‎ تعریف یک تابع به نام : می باشد که هیچ آرگومانی نمی گیرد. تعریف توابع در bash به صورت زیر است:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash"><span style="display:flex"><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id="hl-0-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-1">1</a></span><span>foo<span style="color:#f92672">(){</span>
</span></span><span style="display:flex"><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id="hl-0-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-2">2</a></span><span>  arg1<span style="color:#f92672">=</span>$1
</span></span><span style="display:flex"><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id="hl-0-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-3">3</a></span><span>  arg2<span style="color:#f92672">=</span>$2
</span></span><span style="display:flex"><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id="hl-0-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-4">4</a></span><span>  echo <span style="color:#e6db74">&#39;Bar..&#39;</span>
</span></span><span style="display:flex"><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id="hl-0-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-5">5</a></span><span>  <span style="color:#75715e">#other commands</span>
</span></span><span style="display:flex"><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id="hl-0-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-6">6</a></span><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>بمب خوشه ای به صورت زیر تعریف می شود:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash"><span style="display:flex"><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id="hl-1-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-1">1</a></span><span>:<span style="color:#f92672">(){</span>
</span></span><span style="display:flex"><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id="hl-1-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-2">2</a></span><span>  :|:&amp;
</span></span><span style="display:flex"><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id="hl-1-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-3">3</a></span><span><span style="color:#f92672">}</span>;
</span></span><span style="display:flex"><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id="hl-1-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-4">4</a></span><span>:
</span></span></code></pre></div><p>بنا بر این تابعی به نام : تعریف شده است.</p><p>دستور :|: تابع : را به صورت بازگشتی فراخوانی میکند و خروجی اش را به یک فراخوانی دیگر از : پایپ میکند. بد ترین قسمت قضیه این است که هربار فراخوانی تابع، منجر به دو بار فراخوانی بازگشتی می شود. لذا شاخص رشد این تابع از مرتبه ی نمایی (2n) می باشد.</p><p>علامت & سبب می شود که اجرای بازگشتی تابع وارد background شود و به هیچ وجه قابل متوقف کردن نباشد و پروسه های خوشه ای به صورت نمایی تولید می شوند و منابع سیستم را هدر می دهند.</p><p>علامت ; به معنای پایان تعریف تابع می باشد.</p><p>علامت : در انتها، تابع : را فراخوانی میکند و بمب شروع به کار میکند.</p><p>اگر بخواهیم بمب خوشه ای را به یک شکل خوانا تر بنویسیم، به این صورت خواهد بود:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash"><span style="display:flex"><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id="hl-2-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-1">1</a></span><span>bomb<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex"><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id="hl-2-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-2">2</a></span><span>  bomb | bomb &amp;
</span></span><span style="display:flex"><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id="hl-2-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-3">3</a></span><span><span style="color:#f92672">}</span>; bomb
</span></span></code></pre></div><p>سرور های لینوکس اگر به درستی پیکربندی شده باشند، بمب خوشه ای نمی تواند آن ها را از کار بیاندازد</p><p>شیوه ی مقابله با این بمب را در یک مطلب دیگر شرح خواهم داد.</p><h5>مطالب مرتبط:</h5><ul><li><a href="/posts/1391/01/%D8%A8%D8%AF%D8%B3%D8%AA-%D8%A2%D9%88%D8%B1%D8%AF%D9%86-%D9%86%D8%B3%D8%AE%D9%87-%D9%84%DB%8C%D9%86%D9%88%DA%A9%D8%B3-%D9%88-64-%D8%A8%DB%8C%D8%AA-%DB%8C%D8%A7-32-%D8%A8%DB%8C%D8%AA-%D8%A8%D9%88%D8%AF%D9%86-%D9%88-%D9%86%D8%B3%D8%AE%D9%87%DB%8C-%DA%A9%D8%B1%D9%86%D9%84/">بدست آوردن نسخه لینوکس و 64 بیت یا 32 بیت بودن و نسخه‌ی کرنل</a></li><li><a href="/posts/1390/10/%D8%AA%D9%86%D8%B8%DB%8C%D9%85-boot-order-%D8%AF%D8%B1-grub-%D8%AF%D8%B1-%D8%A7%D9%88%D8%A8%D9%88%D9%86%D8%AA%D9%88/">تنظیم Boot Order در Grub در اوبونتو</a></li></ul></article><div id="comments"><script>
      var disqus_config = function () { 
        this.language = "fa";
      };
    </script><div id="disqus_thread"></div><script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hejazee" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a></div></div><aside class="col-md-3 mt-4"><h3>Monthly Archive</h3><ul><li><a href="/month/1395-06/" title="All posts from 1395-06">1395-06</a> (1)</li><li><a href="/month/1395-01/" title="All posts from 1395-01">1395-01</a> (1)</li><li><a href="/month/1394-12/" title="All posts from 1394-12">1394-12</a> (3)</li><li><a href="/month/1394-08/" title="All posts from 1394-08">1394-08</a> (1)</li><li><a href="/month/1394-07/" title="All posts from 1394-07">1394-07</a> (1)</li><li><a href="/month/1394-03/" title="All posts from 1394-03">1394-03</a> (1)</li><li><a href="/month/1394-02/" title="All posts from 1394-02">1394-02</a> (1)</li><li><a href="/month/1393-12/" title="All posts from 1393-12">1393-12</a> (1)</li><li><a href="/month/1393-07/" title="All posts from 1393-07">1393-07</a> (1)</li><li><a href="/month/1393-06/" title="All posts from 1393-06">1393-06</a> (2)</li><li><a href="/month/1393-05/" title="All posts from 1393-05">1393-05</a> (2)</li><li><a href="/month/1393-04/" title="All posts from 1393-04">1393-04</a> (4)</li><li><a href="/month/1393-03/" title="All posts from 1393-03">1393-03</a> (5)</li><li><a href="/month/1393-02/" title="All posts from 1393-02">1393-02</a> (1)</li><li><a href="/month/1393-01/" title="All posts from 1393-01">1393-01</a> (4)</li><li><a href="/month/1392-12/" title="All posts from 1392-12">1392-12</a> (5)</li><li><a href="/month/1392-10/" title="All posts from 1392-10">1392-10</a> (5)</li><li><a href="/month/1392-06/" title="All posts from 1392-06">1392-06</a> (1)</li><li><a href="/month/1392-04/" title="All posts from 1392-04">1392-04</a> (1)</li><li><a href="/month/1392-02/" title="All posts from 1392-02">1392-02</a> (1)</li><li><a href="/month/1392-01/" title="All posts from 1392-01">1392-01</a> (5)</li><li><a href="/month/1391-11/" title="All posts from 1391-11">1391-11</a> (5)</li><li><a href="/month/1391-10/" title="All posts from 1391-10">1391-10</a> (4)</li><li><a href="/month/1391-09/" title="All posts from 1391-09">1391-09</a> (2)</li><li><a href="/month/1391-08/" title="All posts from 1391-08">1391-08</a> (3)</li><li><a href="/month/1391-07/" title="All posts from 1391-07">1391-07</a> (6)</li><li><a href="/month/1391-05/" title="All posts from 1391-05">1391-05</a> (1)</li><li><a href="/month/1391-04/" title="All posts from 1391-04">1391-04</a> (1)</li><li><a href="/month/1391-03/" title="All posts from 1391-03">1391-03</a> (2)</li><li><a href="/month/1391-02/" title="All posts from 1391-02">1391-02</a> (4)</li><li><a href="/month/1391-01/" title="All posts from 1391-01">1391-01</a> (6)</li><li><a href="/month/1390-12/" title="All posts from 1390-12">1390-12</a> (9)</li><li><a href="/month/1390-11/" title="All posts from 1390-11">1390-11</a> (8)</li><li><a href="/month/1390-10/" title="All posts from 1390-10">1390-10</a> (7)</li><li><a href="/month/1390-09/" title="All posts from 1390-09">1390-09</a> (4)</li><li><a href="/month/1390-08/" title="All posts from 1390-08">1390-08</a> (7)</li><li><a href="/month/1390-07/" title="All posts from 1390-07">1390-07</a> (14)</li><li><a href="/month/1390-06/" title="All posts from 1390-06">1390-06</a> (18)</li></ul></aside></div></div><footer id="footer-wrapper"><div id="footer-bottom-wrapper"><div class="container"><div class="row"><div class="col-12"><p dir="ltr">&copy; Copyright 2011-2022 * Ahmad Hejazee * All rights reserved.</p><small dir="ltr">Proudly Powered by Drupal 10 ;)</small></div></div></div></div></footer><script src="/lib/jQuery/jquery-3.6.0.min.js"></script>
<script src="/lib/bootstrap-5.1.3-dist/js/bootstrap.bundle.min.js"></script></body></html>